using System;
using System.Collections.Generic;
using System.Web;

namespace Sbyt.Balance_Po_VL
{
    public class Class1
    {
        /*
         
           

           

            #region listTablescount3
            else if (listTables.Count == 3)
            {

                if (listTPs.Count == 1)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 1 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 2)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 2 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 3)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 3 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 4)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 4 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 5)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 5 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 6)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 6 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 7)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 7 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 8)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 8 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 9)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 9 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 10)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 10 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 11)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 11 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 12)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 12 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 13)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 13 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 14)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 14 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 15)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                  sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 15 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 16)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 16 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 17)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 17 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 18)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 18 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 19)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 19 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 20)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 20 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 21)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 21 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 22)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 22 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 23)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 23 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 24)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 24 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 25)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 25 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 26)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 26 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 27)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 27 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 28)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 28 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 29)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 29 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 30)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 30 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 31)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 31 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 32)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 32 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 33)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 33 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 34)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 34 ТП")));
                    SQL = sql.ToString();
                }


                else if (listTPs.Count == 35)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 35 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 36)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 36 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 37)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                         sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 37 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 38)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                         sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 38 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 39)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                         sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                   sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 39 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 40)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[39].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 3 таблицы 40 ТП")));
                    SQL = sql.ToString();
                }

            }

            #endregion

            #region listTablesCount4

            else if (listTables.Count == 4)
            {
                                            

                if (listTPs.Count == 1)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 1 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 2)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 2 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 3)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 3 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 4)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 4 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 5)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 5 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 6)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 6 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 7)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4  таблицы 7 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 8)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 8 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 9)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 9 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 10)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 10 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 11)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 11 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 12)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 12 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 13)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 13 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 14)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 14 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 15)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 15 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 16)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 16 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 17)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 17 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 18)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 18 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 19)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 19 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 20)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 20 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 21)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 21 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 22)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 22 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 23)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 23 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 24)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 24 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 25)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 25 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 26)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 26 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 27)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 27 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 28)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 28 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 29)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 29 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 30)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 30 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 31)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 31 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 32)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 32 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 33)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                   
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 33 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 34)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 34 ТП")));
                    SQL = sql.ToString();
                }


                else if (listTPs.Count == 35)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 35 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 36)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 36 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 37)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 37 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 38)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 38 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 39)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 39 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 40)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[39].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 4 таблицы 40 ТП")));
                    SQL = sql.ToString();
                }

                
            }


                     #endregion

            #region listTablesCount5

            else if (listTables.Count == 5)
            {
                
                if (listTPs.Count == 1)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 1 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 2)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 2 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 3)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 3 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 4)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 4 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 5)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 5 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 6)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 6 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 7)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5  таблиц 7 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 8)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 8 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 9)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 9 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 10)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 10 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 11)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 11 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 12)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 12 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 13)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 13 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 14)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 14 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 15)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 15 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 16)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 16 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 17)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 17 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 18)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 18 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 19)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 19 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 20)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 20 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 21)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 21 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 22)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
       
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 22 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 23)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 23 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 24)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");

                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 24 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 25)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 25 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 26)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                                     
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 26 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 27)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 27 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 28)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 28 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 29)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 29 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 30)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 30 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 31)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 31 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 32)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 32 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 33)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 33 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 34)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 34 ТП")));
                    SQL = sql.ToString();
                }


                else if (listTPs.Count == 35)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" AND ");
                 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 35 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 36)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 36 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 37)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 37 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 38)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 38 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 39)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 39 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 40)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
         sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[39].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 5 таблиц 40 ТП")));
                    SQL = sql.ToString();
                }
            }

#endregion

            #region listTablesCount6

            else if (listTables.Count == 6)
            {
                
                if (listTPs.Count == 1)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 1 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 2)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 2 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 3)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 3 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 4)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 4 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 5)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 5 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 6)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 6 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 7)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 7 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 8)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 8 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 9)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 9 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 10)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 10 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 11)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 11 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 12)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 12 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 13)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 13 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 14)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
         sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 14 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 15)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 15 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 16)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");

                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 16 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 17)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 17 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 18)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 18 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 19)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 19 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 20)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 20 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 21)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 21 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 22)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 22 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 23)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 23 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 24)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 24 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 25)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 25 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 26)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 26 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 27)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
     
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 27 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 28)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 28 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 29)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 29 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 30)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 30 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 31)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 31 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 32)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 32 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 33)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 33 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 34)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 34 ТП")));
                    SQL = sql.ToString();
                }


                else if (listTPs.Count == 35)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 35 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 36)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 36 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 37)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 37 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 38)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 38 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 39)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 39 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 40)
                {
                    StringBuilder sql = new StringBuilder();
                    sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                    sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                    sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                    sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                    sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                    sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                    sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString());
                    sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                    sql.Append("," + listTables[5].ToString());
                    sql.Append(" WHERE ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[39].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 6 таблиц 40 ТП")));
                    SQL = sql.ToString();
                }
            }

#endregion
                           
            #region listTablesCount7

            else if (listTables.Count == 7)
            {
                
                if (listTPs.Count == 1)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 1 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 2)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                sql.Append(" OR ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 2 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 3)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 3 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 4)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 4 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 5)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 5 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 6)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 6 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 7)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 7 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 8)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 8 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 9)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 9 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 10)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 10 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 11)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 11 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 12)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 12 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 13)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 13 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 14)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 14 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 15)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 15 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 16)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 16 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 17)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 17 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 18)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
       
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 18 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 19)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                   
  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 19 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 20)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 20 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 21)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 21 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 22)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 22 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 23)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
      
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 23 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 24)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 24 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 25)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 25 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 26)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");

                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 26 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 27)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 27 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 28)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 28 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 29)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 29 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 30)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 30 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 31)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
      
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 31 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 32)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 32 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 33)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 33 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 34)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 34 ТП")));
                    SQL = sql.ToString();
                }


                else if (listTPs.Count == 35)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 35 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 36)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 36 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 37)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 37 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 38)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 38 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 39)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 39 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 40)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                    sql.Append(" AND ");
   		    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[39].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 40 ТП")));
                    SQL = sql.ToString();
                }
            }

#endregion
                        
            #region listTablesCount8

            else if (listTables.Count == 8)
            {
                
                if (listTPs.Count == 1)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 1 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 2)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                sql.Append(" OR ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 2 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 3)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 3 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 4)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 7 таблиц 4 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 5)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 5 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 6)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 6 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 7)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 7 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 8)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 8 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 9)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 9 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 10)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 10 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 11)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
       
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 11 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 12)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
     
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 12 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 13)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
       
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 13 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 14)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 14 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 15)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
      
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 15 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 16)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 16 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 17)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 17 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 18)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 18 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 19)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
       
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 19 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 20)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 20 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 21)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 21 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 22)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
        
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 22 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 23)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 23 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 24)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
       
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 24 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 25)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 25 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 26)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 26 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 27)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 27 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 28)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 28 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 29)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 29 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 30)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 30 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 31)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 31 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 32)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 32 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 33)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 33 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 34)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 34 ТП")));
                    SQL = sql.ToString();
                }


                else if (listTPs.Count == 35)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 35 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 36)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 36 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 37)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 37 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 38)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 38 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 39)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 39 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 40)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[39].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 8 таблиц 40 ТП")));
                    SQL = sql.ToString();
                }
            }

#endregion

            #region listTablesCount9

            else if (listTables.Count == 9)
            {
                
                if (listTPs.Count == 1)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 1 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 2)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                sql.Append(" OR ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 2 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 3)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 3 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 4)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 4 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 5)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 5 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 6)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 6 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 7)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 7 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 8)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 8 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 9)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 9 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 10)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 10 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 11)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 11 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 12)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 12 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 13)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 13 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 14)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 14 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 15)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 15 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 16)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 16 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 17)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 17 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 18)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
         sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 18 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 19)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 19 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 20)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 20 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 21)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");

                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 21 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 22)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 22 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 23)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 23 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 24)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 24 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 25)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 25 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 26)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 26 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 27)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 27 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 28)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 28 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 29)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 29 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 30)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 30 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 31)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 31 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 32)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 32 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 33)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 33 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 34)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 34 ТП")));
                    SQL = sql.ToString();
                }


                else if (listTPs.Count == 35)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 35 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 36)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 36 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 37)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 37 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 38)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 38 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 39)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 39 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 40)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[39].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 9 таблиц 40 ТП")));
                    SQL = sql.ToString();
                }
            }

#endregion

            #region listTablesCount10

            else if (listTables.Count == 10)
            {
                
                if (listTPs.Count == 1)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 1 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 2)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                sql.Append(" OR ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 2 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 3)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 3 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 4)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 4 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 5)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 5 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 6)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 6 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 7)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 7 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 8)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 8 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 9)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 9 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 10)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 10 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 11)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
      
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 11 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 12)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
         sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 12 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 13)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
       
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 13 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 14)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 14 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 15)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
       
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 15 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 16)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 16 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 17)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 17 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 18)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
          sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 18 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 19)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
        
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 19 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 20)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
      
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 20 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 21)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
       
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 21 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 22)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
         sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 22 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 23)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
          
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 23 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 24)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 24 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 25)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 25 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 26)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
               sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 26 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 27)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 27 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 28)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 28 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 29)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 29 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 30)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 30 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 31)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 31 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 32)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 32 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 33)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 33 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 34)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 34 ТП")));
                    SQL = sql.ToString();
                }


                else if (listTPs.Count == 35)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 35 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 36)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 36 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 37)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 37 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 38)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 38 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 39)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
              sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
           
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 39 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 40)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[39].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 10 таблиц 40 ТП")));
                    SQL = sql.ToString();
                }
            }

#endregion

            #region listTablesCount11

            else if (listTables.Count == 11)
            {
                
                if (listTPs.Count == 1)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 1 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 2)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                sql.Append(" OR ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 2 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 3)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 3 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 4)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 4 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 5)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 5 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 6)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 6 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 7)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 7 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 8)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 8 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 9)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 9 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 10)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 10 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 11)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 11 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 12)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 12 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 13)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 13 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 14)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 14 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 15)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 15 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 16)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 16 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 17)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 17 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 18)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 18 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 19)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 19 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 20)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 20 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 21)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 21 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 22)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 22 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 23)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 23 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 24)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 24 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 25)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 25 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 26)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 26 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 27)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
            
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 27 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 28)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 28 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 29)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 29 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 30)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
             
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 30 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 31)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 31 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 32)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 32 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 33)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                      sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 33 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 34)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 34 ТП")));
                    SQL = sql.ToString();
                }


                else if (listTPs.Count == 35)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 35 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 36)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 36 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 37)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 37 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 38)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 38 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 39)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                        sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 39 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 40)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString());
                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString());
                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                    sql.Append(" AND ");
                       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[39].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 11 таблиц 40 ТП")));
                    SQL = sql.ToString();
                }
            }

#endregion

            #region listTablesCount12

            else if (listTables.Count == 12)
            {
                
                if (listTPs.Count == 1)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 1 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 2)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 2 ТП")));
                SQL = sql.ToString();
                }

                else if (listTPs.Count == 3)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 3 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 4)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 4 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 5)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 5 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 6)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 6 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 7)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 7 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 8)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 8 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 9)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 9 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 10)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[0].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 10 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 11)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
       sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 11 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 12)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 12 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 13)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");

                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 13 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 14)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
 sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
         
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 14 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 15)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 15 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 16)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
            sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 16 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 17)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                                      
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 17 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 18)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
               
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 18 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 19)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
           sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 19 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 20)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 20 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 21)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 21 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 22)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
        
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 22 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 23)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                  
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 23 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 24)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                 
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 24 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 25)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 25 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 26)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 26 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 27)
                {
                  StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 27 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 28)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 28 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 29)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
             sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 29 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 30)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
              
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 30 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 31)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 31 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 32)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 32 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 33)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 33 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 34)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                   sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 34 ТП")));
                    SQL = sql.ToString();
                }


                else if (listTPs.Count == 35)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 35 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 36)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                  sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 36 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 37)
                {
                   StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 37 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 38)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 38 ТП")));
                    SQL = sql.ToString();
                }

                else if (listTPs.Count == 39)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                     sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                   
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 39 ТП")));
                    SQL = sql.ToString();
                }
                else if (listTPs.Count == 40)
                {
                    StringBuilder sql = new StringBuilder();
                sql.Append("SELECT " + listTables[0].ToString() + ".N1 as Плательщик," + listTables[0].ToString() + ".N2 as Абонент," + listTables[0].ToString() + ".N3 as Точка_учета,");
                sql.Append("(" + listTables[0].ToString() + ".OTPUSK +" + listTables[0].ToString() + ".POTERI) AS Оплата_" + listTables[0].ToString() + ",");
                sql.Append("(" + listTables[1].ToString() + ".OTPUSK +" + listTables[1].ToString() + ".POTERI) AS Оплата_" + listTables[1].ToString() + ",");
                sql.Append("(" + listTables[2].ToString() + ".OTPUSK +" + listTables[2].ToString() + ".POTERI) AS Оплата_" + listTables[2].ToString() + ",");
                sql.Append("(" + listTables[3].ToString() + ".OTPUSK +" + listTables[3].ToString() + ".POTERI) AS Оплата_" + listTables[3].ToString() + ",");
                sql.Append("(" + listTables[4].ToString() + ".OTPUSK +" + listTables[4].ToString() + ".POTERI) AS Оплата_" + listTables[4].ToString() + ",");
                sql.Append("(" + listTables[5].ToString() + ".OTPUSK +" + listTables[5].ToString() + ".POTERI) AS Оплата_" + listTables[5].ToString() + ",");
                sql.Append("(" + listTables[6].ToString() + ".OTPUSK +" + listTables[6].ToString() + ".POTERI) AS Оплата_" + listTables[6].ToString() + ",");
                sql.Append("(" + listTables[7].ToString() + ".OTPUSK +" + listTables[7].ToString() + ".POTERI) AS Оплата_" + listTables[7].ToString() + ",");
                sql.Append("(" + listTables[8].ToString() + ".OTPUSK +" + listTables[8].ToString() + ".POTERI) AS Оплата_" + listTables[8].ToString() + ",");
                sql.Append("(" + listTables[9].ToString() + ".OTPUSK +" + listTables[9].ToString() + ".POTERI) AS Оплата_" + listTables[9].ToString() + ",");
                sql.Append("(" + listTables[10].ToString() + ".OTPUSK +" + listTables[10].ToString() + ".POTERI) AS Оплата_" + listTables[10].ToString() + ",");
                sql.Append("(" + listTables[11].ToString() + ".OTPUSK +" + listTables[11].ToString() + ".POTERI) AS Оплата_" + listTables[11].ToString());

                sql.Append(" FROM " + listTables[0].ToString() + "," + listTables[1].ToString() + "," + listTables[2].ToString() + "," + listTables[3].ToString() + "," + listTables[4].ToString());
                sql.Append("," + listTables[5].ToString() + "," + listTables[6].ToString() + "," + listTables[7].ToString() + "," + listTables[8].ToString());
                sql.Append("," + listTables[9].ToString() + "," + listTables[10].ToString() + "," + listTables[11].ToString());

                sql.Append(" WHERE ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[1].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[1].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[1].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[2].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[2].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[2].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[3].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[3].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[3].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[4].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[4].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[4].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[5].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[5].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[5].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[6].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[6].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[6].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[7].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[7].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[7].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[8].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[8].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[8].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[9].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[9].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[9].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[10].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[10].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[10].ToString() + ".KTU");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KP = " + listTables[11].ToString() + ".KP");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".NAB = " + listTables[11].ToString() + ".NAB");
                sql.Append(" AND ");
                sql.Append(listTables[0].ToString() + ".KTU = " + listTables[11].ToString() + ".KTU");
                    sql.Append(" AND ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[1].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[2].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[3].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[4].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[5].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[6].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[7].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[8].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[9].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[10].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[11].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[12].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[13].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[14].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[15].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[16].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[17].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[18].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[19].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[20].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[21].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[22].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[23].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[24].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[25].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[26].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[27].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[28].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[29].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[30].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[31].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[32].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[33].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[34].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[35].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[36].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[37].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[38].ToString() + "'");
                    sql.Append(" OR ");
                    sql.Append(listTables[0].ToString() + ".KODTP = " + "'" + listTPs[39].ToString() + "'");
                    Logger.Instance.WriteToLogFile(ConfigurationHelper.ErrorLogPathBalancePoVL, (string.Format("Запрос: 12 таблиц 40 ТП")));
                    SQL = sql.ToString();
                }
            }

#endregion
         */
          
        
    }
}